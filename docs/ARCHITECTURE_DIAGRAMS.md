# CRONOS AI - Architecture Diagrams

This document contains architecture diagrams for the modernized CRONOS AI platform.

---

## 1. High-Level System Architecture (Target State)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           CRONOS AI Platform v2.0                                │
│                      Quantum-Safe Enterprise Security                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        EXTERNAL INTERFACES                               │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │    │
│  │  │   Web UI    │  │  REST API   │  │  gRPC API   │  │  WebSocket  │    │    │
│  │  │  (React)    │  │  (FastAPI)  │  │ (Protocol)  │  │  (Events)   │    │    │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘    │    │
│  └─────────┼────────────────┼────────────────┼────────────────┼───────────┘    │
│            │                │                │                │                  │
│  ┌─────────▼────────────────▼────────────────▼────────────────▼───────────┐    │
│  │                      GATEWAY LAYER (Gateway API)                        │    │
│  │  ┌──────────────────────────────────────────────────────────────────┐  │    │
│  │  │  Istio Gateway  │  mTLS (Kyber-1024)  │  Rate Limiting  │  WAF  │  │    │
│  │  └──────────────────────────────────────────────────────────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                        SERVICE MESH (Cilium + Istio)                     │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐    │   │
│  │  │  L7 Network Policies  │  eBPF Observability  │  Zero-Trust mTLS │    │   │
│  │  └─────────────────────────────────────────────────────────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                         AGENTIC AI LAYER                                 │   │
│  │                                                                          │   │
│  │  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐       │   │
│  │  │  Protocol        │  │  Threat          │  │  Compliance      │       │   │
│  │  │  Analysis        │  │  Assessment      │  │  Verification    │       │   │
│  │  │  Agent           │  │  Agent           │  │  Agent           │       │   │
│  │  │  (LangGraph)     │  │  (LangGraph)     │  │  (LangGraph)     │       │   │
│  │  └────────┬─────────┘  └────────┬─────────┘  └────────┬─────────┘       │   │
│  │           │                     │                     │                  │   │
│  │  ┌────────▼─────────────────────▼─────────────────────▼─────────┐       │   │
│  │  │              UNIFIED LLM SERVICE (LiteLLM)                    │       │   │
│  │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐         │       │   │
│  │  │  │ Ollama  │  │  vLLM   │  │ Claude  │  │  GPT-4  │         │       │   │
│  │  │  │ (Local) │  │ (Local) │  │ (Cloud) │  │ (Cloud) │         │       │   │
│  │  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘         │       │   │
│  │  │                    ▲ Fallback Chain                          │       │   │
│  │  └──────────────────────────────────────────────────────────────┘       │   │
│  │                                                                          │   │
│  │  ┌──────────────────────────────────────────────────────────────┐       │   │
│  │  │            ZERO-TOUCH DECISION ENGINE (78% Autonomous)        │       │   │
│  │  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │       │   │
│  │  │   │ Risk-Based  │  │  Auto       │  │  Human      │          │       │   │
│  │  │   │ Decisioning │  │  Execution  │  │  Escalation │          │       │   │
│  │  │   └─────────────┘  └─────────────┘  └─────────────┘          │       │   │
│  │  └──────────────────────────────────────────────────────────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                          CORE SERVICES                                   │   │
│  │                                                                          │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  Protocol     │  │  Translation  │  │  Marketplace  │                │   │
│  │  │  Discovery    │  │  Studio       │  │  Engine       │                │   │
│  │  │  Engine       │  │  (API Gen)    │  │  (1000+ proto)│                │   │
│  │  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘                │   │
│  │          │                  │                  │                         │   │
│  │  ┌───────▼───────┐  ┌───────▼───────┐  ┌───────▼───────┐                │   │
│  │  │  Field        │  │  Code         │  │  Commerce     │                │   │
│  │  │  Detection    │  │  Generation   │  │  Engine       │                │   │
│  │  │  (BiLSTM-CRF) │  │  (6 Languages)│  │  (Stripe)     │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  │                                                                          │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  Anomaly      │  │  Threat       │  │  Compliance   │                │   │
│  │  │  Detection    │  │  Intelligence │  │  Automation   │                │   │
│  │  │  (Ensemble)   │  │  (MITRE ATT&CK)│  │  (7 frameworks)│               │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                          MLOps LAYER                                     │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  MLflow       │  │  Evidently    │  │  Feast        │                │   │
│  │  │  Model        │  │  Drift        │  │  Feature      │                │   │
│  │  │  Registry     │  │  Detection    │  │  Store        │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                          DATA LAYER                                      │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  PostgreSQL   │  │  Redis        │  │  Qdrant       │                │   │
│  │  │  (Primary DB) │  │  (Cache/Queue)│  │  (Vector DB)  │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  │                                                                          │   │
│  │  ┌───────────────┐  ┌───────────────┐                                   │   │
│  │  │  Kafka        │  │  S3           │                                   │   │
│  │  │  (Events)     │  │  (Files)      │                                   │   │
│  │  │  AES-256-GCM  │  │  Encrypted    │                                   │   │
│  │  └───────────────┘  └───────────────┘                                   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                      OBSERVABILITY (LGTM Stack)                          │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  Loki         │  │  Grafana      │  │  Tempo        │                │   │
│  │  │  (Logs)       │  │  (Dashboards) │  │  (Traces)     │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  │                                                                          │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  Mimir        │  │  Cilium       │  │  Falco        │                │   │
│  │  │  (Metrics)    │  │  Hubble       │  │  (Runtime)    │                │   │
│  │  │               │  │  (eBPF)       │  │               │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                         │
│  ┌─────────────────────────────────────▼───────────────────────────────────┐   │
│  │                    INFRASTRUCTURE (GitOps)                               │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐                │   │
│  │  │  ArgoCD       │  │  Kyverno      │  │  Karpenter    │                │   │
│  │  │  (GitOps)     │  │  (Policies)   │  │  (Autoscale)  │                │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘                │   │
│  │                                                                          │   │
│  │  ┌──────────────────────────────────────────────────────────────┐       │   │
│  │  │              Kubernetes Cluster (EKS/GKE/AKS)                 │       │   │
│  │  │     Pod Security Standards  │  Network Policies  │  RBAC     │       │   │
│  │  └──────────────────────────────────────────────────────────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                          POST-QUANTUM CRYPTOGRAPHY                               │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐    │
│  │  Kyber-1024   │  │  Dilithium-5  │  │  AES-256-GCM  │  │  SPHINCS+     │    │
│  │  (KEM)        │  │  (Signatures) │  │  (Symmetric)  │  │  (Backup)     │    │
│  │  12K ops/sec  │  │  8K ops/sec   │  │  120K msg/sec │  │  NIST Level 5 │    │
│  └───────────────┘  └───────────────┘  └───────────────┘  └───────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Agentic AI Architecture (LangGraph)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    PROTOCOL ANALYSIS WORKFLOW (LangGraph)                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│                              ┌─────────────────┐                                 │
│                              │     START       │                                 │
│                              │  (Protocol Data)│                                 │
│                              └────────┬────────┘                                 │
│                                       │                                          │
│                                       ▼                                          │
│                         ┌─────────────────────────┐                             │
│                         │     CLASSIFICATION      │                             │
│                         │     ┌─────────────┐    │                             │
│                         │     │ CNN Model   │    │                             │
│                         │     │ Byte Stream │    │                             │
│                         │     └─────────────┘    │                             │
│                         └───────────┬────────────┘                             │
│                                     │                                           │
│                    ┌────────────────┼────────────────┐                         │
│                    │                │                │                         │
│                    ▼                ▼                ▼                         │
│            ┌──────────┐     ┌──────────┐     ┌──────────┐                     │
│            │  Known   │     │ Unknown  │     │  Error   │                     │
│            │ Protocol │     │ Protocol │     │  State   │                     │
│            └────┬─────┘     └────┬─────┘     └────┬─────┘                     │
│                 │                │                │                            │
│                 ▼                ▼                ▼                            │
│  ┌───────────────────────────────────────────────────────────────────┐       │
│  │                    FIELD EXTRACTION                                │       │
│  │  ┌─────────────────────────────────────────────────────────────┐  │       │
│  │  │                BiLSTM-CRF Field Detector                     │  │       │
│  │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │  │       │
│  │  │  │ Header  │  │ Length  │  │ Payload │  │ Checksum│        │  │       │
│  │  │  │ Fields  │  │ Fields  │  │ Fields  │  │ Fields  │        │  │       │
│  │  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘        │  │       │
│  │  └─────────────────────────────────────────────────────────────┘  │       │
│  └───────────────────────────────────────────────────────────────────┘       │
│                                     │                                          │
│                                     ▼                                          │
│  ┌───────────────────────────────────────────────────────────────────┐       │
│  │                    THREAT ASSESSMENT                               │       │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐         │       │
│  │  │    LLM        │  │   MITRE       │  │   Anomaly     │         │       │
│  │  │  Analysis     │  │   ATT&CK      │  │   Detection   │         │       │
│  │  │  (LiteLLM)    │  │   Mapping     │  │   (Ensemble)  │         │       │
│  │  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘         │       │
│  │          │                  │                  │                  │       │
│  │          └──────────────────┼──────────────────┘                  │       │
│  │                             ▼                                      │       │
│  │                     ┌──────────────┐                               │       │
│  │                     │ Risk Score   │                               │       │
│  │                     │ Calculation  │                               │       │
│  │                     └──────────────┘                               │       │
│  └───────────────────────────────────────────────────────────────────┘       │
│                                     │                                          │
│               ┌─────────────────────┼─────────────────────┐                   │
│               │                     │                     │                   │
│               ▼                     ▼                     ▼                   │
│        ┌──────────┐          ┌──────────┐          ┌──────────┐              │
│        │   LOW    │          │  MEDIUM  │          │   HIGH   │              │
│        │   Risk   │          │   Risk   │          │   Risk   │              │
│        │ (Score<3)│          │(Score 3-7)│          │(Score>7) │              │
│        └────┬─────┘          └────┬─────┘          └────┬─────┘              │
│             │                     │                     │                     │
│             ▼                     ▼                     ▼                     │
│  ┌───────────────────────────────────────────────────────────────────┐       │
│  │                    COMPLIANCE CHECK                                │       │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │       │
│  │  │  GDPR   │  │  SOC2   │  │ PCI-DSS │  │  HIPAA  │  │NIST CSF │ │       │
│  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────┘ │       │
│  └───────────────────────────────────────────────────────────────────┘       │
│                                     │                                          │
│                                     ▼                                          │
│  ┌───────────────────────────────────────────────────────────────────┐       │
│  │                    REPORT GENERATION                               │       │
│  │  ┌──────────────────────────────────────────────────────────────┐ │       │
│  │  │  {                                                           │ │       │
│  │  │    "protocol_name": "Custom Banking Protocol v2",            │ │       │
│  │  │    "classification": { ... },                                │ │       │
│  │  │    "fields": [ ... ],                                        │ │       │
│  │  │    "threats": [ ... ],                                       │ │       │
│  │  │    "compliance": { ... },                                    │ │       │
│  │  │    "risk_score": 6.5,                                        │ │       │
│  │  │    "recommendations": [ ... ]                                │ │       │
│  │  │  }                                                           │ │       │
│  │  └──────────────────────────────────────────────────────────────┘ │       │
│  └───────────────────────────────────────────────────────────────────┘       │
│                                     │                                          │
│                                     ▼                                          │
│                              ┌─────────────┐                                   │
│                              │     END     │                                   │
│                              └─────────────┘                                   │
│                                                                                   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. MLOps Pipeline Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           MLOps PIPELINE                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                         DATA PIPELINE                                       │ │
│  │                                                                             │ │
│  │   ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐         │ │
│  │   │  Raw     │────▶│  Feature │────▶│  Feature │────▶│  Training│         │ │
│  │   │  Data    │     │  Engine  │     │  Store   │     │  Dataset │         │ │
│  │   │  (Kafka) │     │          │     │  (Feast) │     │          │         │ │
│  │   └──────────┘     └──────────┘     └──────────┘     └──────────┘         │ │
│  │        │                                                   │               │ │
│  │        │           ┌──────────────────────────────────────┘               │ │
│  │        ▼           ▼                                                       │ │
│  │   ┌──────────────────────────────────────────────────────────────────┐    │ │
│  │   │                    TRAINING PIPELINE                              │    │ │
│  │   │                                                                   │    │ │
│  │   │   ┌────────────┐    ┌────────────┐    ┌────────────┐             │    │ │
│  │   │   │  Optuna    │───▶│  PyTorch   │───▶│  MLflow    │             │    │ │
│  │   │   │  Hyperopt  │    │  Training  │    │  Logging   │             │    │ │
│  │   │   └────────────┘    └────────────┘    └────────────┘             │    │ │
│  │   │                            │                 │                    │    │ │
│  │   │                            ▼                 ▼                    │    │ │
│  │   │                     ┌────────────┐    ┌────────────┐             │    │ │
│  │   │                     │  Model     │───▶│  MLflow    │             │    │ │
│  │   │                     │  Artifacts │    │  Registry  │             │    │ │
│  │   │                     └────────────┘    └────────────┘             │    │ │
│  │   └──────────────────────────────────────────────────────────────────┘    │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                      MODEL LIFECYCLE                                        │ │
│  │                                                                             │ │
│  │   ┌──────────────────────────────────────────────────────────────────┐    │ │
│  │   │                   MLflow Model Registry                           │    │ │
│  │   │                                                                   │    │ │
│  │   │   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐      │    │ │
│  │   │   │  None   │───▶│ Staging │───▶│Production│───▶│ Archived│      │    │ │
│  │   │   │         │    │  (Test) │    │  (Live) │    │         │      │    │ │
│  │   │   └─────────┘    └─────────┘    └─────────┘    └─────────┘      │    │ │
│  │   │                       │              │                           │    │ │
│  │   │                       ▼              ▼                           │    │ │
│  │   │              ┌────────────────┬────────────────┐                │    │ │
│  │   │              │    A/B Test    │  Shadow Mode   │                │    │ │
│  │   │              │    (10/90)     │  (Validation)  │                │    │ │
│  │   │              └────────────────┴────────────────┘                │    │ │
│  │   └──────────────────────────────────────────────────────────────────┘    │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                      MODEL MONITORING                                       │ │
│  │                                                                             │ │
│  │   ┌───────────────────┐         ┌───────────────────┐                     │ │
│  │   │  Production Data  │────────▶│   Evidently AI    │                     │ │
│  │   │    (Streaming)    │         │  Drift Detection  │                     │ │
│  │   └───────────────────┘         └─────────┬─────────┘                     │ │
│  │                                           │                                │ │
│  │                    ┌──────────────────────┼──────────────────────┐        │ │
│  │                    │                      │                      │        │ │
│  │                    ▼                      ▼                      ▼        │ │
│  │            ┌──────────────┐      ┌──────────────┐      ┌──────────────┐  │ │
│  │            │  Data Drift  │      │ Prediction   │      │   Feature    │  │ │
│  │            │  Detection   │      │    Drift     │      │   Drift      │  │ │
│  │            └──────┬───────┘      └──────┬───────┘      └──────┬───────┘  │ │
│  │                   │                     │                     │          │ │
│  │                   └─────────────────────┼─────────────────────┘          │ │
│  │                                         ▼                                 │ │
│  │                               ┌──────────────────┐                       │ │
│  │                               │   Alert System   │                       │ │
│  │                               │ (PagerDuty/Slack)│                       │ │
│  │                               └────────┬─────────┘                       │ │
│  │                                        │                                  │ │
│  │                    ┌───────────────────┼───────────────────┐             │ │
│  │                    ▼                   ▼                   ▼             │ │
│  │            ┌──────────────┐   ┌──────────────┐   ┌──────────────┐       │ │
│  │            │  Auto        │   │   Manual     │   │  Automated   │       │ │
│  │            │  Rollback    │   │   Review     │   │  Retrain     │       │ │
│  │            └──────────────┘   └──────────────┘   └──────────────┘       │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. Kubernetes Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                    KUBERNETES DEPLOYMENT ARCHITECTURE                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                          ArgoCD (GitOps)                                    │ │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                   │ │
│  │   │    Git      │───▶│   ArgoCD    │───▶│  Kubernetes │                   │ │
│  │   │  Repository │    │   Server    │    │   Cluster   │                   │ │
│  │   └─────────────┘    └─────────────┘    └─────────────┘                   │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                    NAMESPACE: cronos-ai-prod                                │ │
│  │                    (Pod Security: Restricted)                               │ │
│  │                                                                             │ │
│  │   ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │   │                    Gateway API                                       │ │ │
│  │   │   ┌────────────────────────────────────────────────────────────┐   │ │ │
│  │   │   │  Gateway (Istio)  │  HTTPRoute  │  GRPCRoute  │  TLS Term │   │ │ │
│  │   │   └────────────────────────────────────────────────────────────┘   │ │ │
│  │   └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                      │                                    │ │
│  │   ┌──────────────────────────────────┼──────────────────────────────────┐│ │
│  │   │                                  ▼                                  ││ │
│  │   │   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐        ││ │
│  │   │   │  AI Engine   │    │  Marketplace │    │  Protocol    │        ││ │
│  │   │   │  Deployment  │    │  Deployment  │    │  Processor   │        ││ │
│  │   │   │  (3 replicas)│    │  (3 replicas)│    │  (5 replicas)│        ││ │
│  │   │   └──────┬───────┘    └──────┬───────┘    └──────┬───────┘        ││ │
│  │   │          │                   │                   │                 ││ │
│  │   │   ┌──────▼───────┐    ┌──────▼───────┐    ┌──────▼───────┐        ││ │
│  │   │   │    HPA       │    │    HPA       │    │    HPA       │        ││ │
│  │   │   │ (CPU/Custom) │    │ (CPU/Memory) │    │ (Custom Met) │        ││ │
│  │   │   └──────────────┘    └──────────────┘    └──────────────┘        ││ │
│  │   └──────────────────────────────────────────────────────────────────────┘│ │
│  │                                      │                                    │ │
│  │   ┌──────────────────────────────────▼──────────────────────────────────┐│ │
│  │   │                    Cilium Network Policies                          ││ │
│  │   │   ┌────────────────────────────────────────────────────────────┐   ││ │
│  │   │   │  L7 Policies  │  Default Deny  │  eBPF Enforcement         │   ││ │
│  │   │   └────────────────────────────────────────────────────────────┘   ││ │
│  │   └──────────────────────────────────────────────────────────────────────┘│ │
│  │                                      │                                    │ │
│  │   ┌──────────────────────────────────▼──────────────────────────────────┐│ │
│  │   │                    Kyverno Policy Engine                            ││ │
│  │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐               ││ │
│  │   │   │  Validation │  │  Mutation   │  │  Generation │               ││ │
│  │   │   │  Policies   │  │  Policies   │  │  Policies   │               ││ │
│  │   │   └─────────────┘  └─────────────┘  └─────────────┘               ││ │
│  │   └──────────────────────────────────────────────────────────────────────┘│ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                    NAMESPACE: monitoring                                    │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │    Loki     │  │   Grafana   │  │    Tempo    │  │    Mimir    │     │ │
│  │   │   (Logs)    │  │ (Dashboards)│  │  (Traces)   │  │  (Metrics)  │     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐                                        │ │
│  │   │   Hubble    │  │   Falco     │                                        │ │
│  │   │   (eBPF)    │  │  (Runtime)  │                                        │ │
│  │   └─────────────┘  └─────────────┘                                        │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                    NAMESPACE: data                                          │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │ PostgreSQL  │  │    Redis    │  │   Qdrant    │  │    Kafka    │     │ │
│  │   │  (Primary)  │  │  (Cache)    │  │  (Vectors)  │  │  (Events)   │     │ │
│  │   │ StatefulSet │  │ StatefulSet │  │ StatefulSet │  │ StatefulSet │     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                    NODE POOLS (Karpenter)                                   │ │
│  │                                                                             │ │
│  │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐           │ │
│  │   │   General       │  │    GPU          │  │    Spot         │           │ │
│  │   │   Workloads     │  │    Workloads    │  │    Workloads    │           │ │
│  │   │   (On-Demand)   │  │   (ML Training) │  │  (Batch Jobs)   │           │ │
│  │   └─────────────────┘  └─────────────────┘  └─────────────────┘           │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. Security Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        SECURITY ARCHITECTURE                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        PERIMETER SECURITY                                   │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │    WAF      │  │    DDoS     │  │   API       │  │    CDN      │     │ │
│  │   │ (ModSecurity)│  │ Protection │  │  Gateway    │  │ (CloudFlare)│     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        IDENTITY & ACCESS                                    │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │   OAuth2    │  │    OIDC     │  │    RBAC     │  │    ABAC     │     │ │
│  │   │   (SSO)     │  │   (JWT)     │  │   (K8s)     │  │  (Policies) │     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  │                                                                             │ │
│  │   ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │   │                    Multi-Factor Authentication                       │ │ │
│  │   │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐               │ │ │
│  │   │   │ Password│  │  TOTP   │  │  WebAuthn│  │   SMS   │               │ │ │
│  │   │   │         │  │ (2FA)   │  │  (FIDO2)│  │  Backup │               │ │ │
│  │   │   └─────────┘  └─────────┘  └─────────┘  └─────────┘               │ │ │
│  │   └─────────────────────────────────────────────────────────────────────┘ │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        NETWORK SECURITY                                     │ │
│  │                                                                             │ │
│  │   ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │   │                    Zero-Trust Architecture                           │ │ │
│  │   │                                                                      │ │ │
│  │   │   ┌─────────────┐       ┌─────────────┐       ┌─────────────┐      │ │ │
│  │   │   │   mTLS      │──────▶│  Service    │──────▶│   mTLS      │      │ │ │
│  │   │   │  (Ingress)  │       │   Mesh      │       │  (Egress)   │      │ │ │
│  │   │   │ Kyber-1024  │       │  (Cilium)   │       │ Kyber-1024  │      │ │ │
│  │   │   └─────────────┘       └─────────────┘       └─────────────┘      │ │ │
│  │   │                               │                                     │ │ │
│  │   │                               ▼                                     │ │ │
│  │   │   ┌─────────────────────────────────────────────────────────────┐  │ │ │
│  │   │   │              L7 Network Policies (Cilium)                   │  │ │ │
│  │   │   │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐       │  │ │ │
│  │   │   │  │ HTTP    │  │  gRPC   │  │  DNS    │  │  Kafka  │       │  │ │ │
│  │   │   │  │ Policies│  │ Policies│  │ Policies│  │ Policies│       │  │ │ │
│  │   │   │  └─────────┘  └─────────┘  └─────────┘  └─────────┘       │  │ │ │
│  │   │   └─────────────────────────────────────────────────────────────┘  │ │ │
│  │   └─────────────────────────────────────────────────────────────────────┘ │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        DATA SECURITY                                        │ │
│  │                                                                             │ │
│  │   ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │   │                    Encryption at Rest                                │ │ │
│  │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐               │ │ │
│  │   │   │ Database    │  │    S3       │  │   Secrets   │               │ │ │
│  │   │   │ (AES-256)   │  │ (SSE-KMS)   │  │ (Vault)     │               │ │ │
│  │   │   └─────────────┘  └─────────────┘  └─────────────┘               │ │ │
│  │   └─────────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                             │ │
│  │   ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │   │                    Encryption in Transit                             │ │ │
│  │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐               │ │ │
│  │   │   │ TLS 1.3 +   │  │   mTLS      │  │   Kafka     │               │ │ │
│  │   │   │ Kyber-1024  │  │ (Dilithium) │  │ (AES-256-GCM)│              │ │ │
│  │   │   └─────────────┘  └─────────────┘  └─────────────┘               │ │ │
│  │   └─────────────────────────────────────────────────────────────────────┘ │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        RUNTIME SECURITY                                     │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │   Falco     │  │   Kyverno   │  │  Trivy      │  │   Sandbox   │     │ │
│  │   │ (Runtime    │  │  (Policy    │  │ (Vuln Scan) │  │  (Parser    │     │ │
│  │   │  Monitor)   │  │   Engine)   │  │             │  │   Isolation)│     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                          │
│                                      ▼                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │                        AUDIT & COMPLIANCE                                   │ │
│  │                                                                             │ │
│  │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │ │
│  │   │   SIEM      │  │  Audit      │  │ Compliance  │  │  Incident   │     │ │
│  │   │  (Splunk/   │  │   Logs      │  │  Reports    │  │  Response   │     │ │
│  │   │   ELK)      │  │ (Immutable) │  │ (Automated) │  │  (Playbooks)│     │ │
│  │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         DATA FLOW ARCHITECTURE                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│   USER REQUEST                                                                   │
│        │                                                                          │
│        ▼                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  1. API Gateway                                                          │   │
│   │     ├── Rate Limiting (Redis)                                            │   │
│   │     ├── Authentication (JWT/OAuth2)                                      │   │
│   │     ├── Request Validation (Pydantic)                                    │   │
│   │     └── Load Balancing                                                   │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                          │
│        ▼                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  2. Protocol Analysis Request                                            │   │
│   │     │                                                                     │   │
│   │     ├──▶ [Kafka] ──▶ Event Stream (AES-256-GCM encrypted)               │   │
│   │     │                                                                     │   │
│   │     └──▶ [AI Engine]                                                     │   │
│   │           │                                                               │   │
│   │           ├── Classification (CNN Model)                                 │   │
│   │           │      └── Cache Check (Redis)                                 │   │
│   │           │                                                               │   │
│   │           ├── Field Detection (BiLSTM-CRF)                               │   │
│   │           │      └── Model Load (MLflow Registry)                        │   │
│   │           │                                                               │   │
│   │           ├── Knowledge Lookup (Qdrant)                                  │   │
│   │           │      └── Semantic Search (Sentence Transformers)             │   │
│   │           │                                                               │   │
│   │           └── LLM Analysis (LiteLLM)                                     │   │
│   │                  ├── Ollama (Primary - Local)                            │   │
│   │                  ├── Claude (Fallback 1)                                 │   │
│   │                  └── GPT-4 (Fallback 2)                                  │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                          │
│        ▼                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  3. Threat Assessment                                                    │   │
│   │     │                                                                     │   │
│   │     ├── MITRE ATT&CK Mapping                                             │   │
│   │     ├── Anomaly Detection (Ensemble)                                     │   │
│   │     │      ├── Isolation Forest                                          │   │
│   │     │      ├── LSTM Detector                                             │   │
│   │     │      └── VAE Detector                                              │   │
│   │     │                                                                     │   │
│   │     └── Risk Score Calculation                                           │   │
│   │            └── Store Result (PostgreSQL)                                 │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                          │
│        ├───────────────────────────────────────────────────────────────────┐    │
│        │                                                                   │    │
│        ▼                                                                   ▼    │
│   ┌─────────────────────────────┐       ┌─────────────────────────────┐        │
│   │  4A. Low/Medium Risk        │       │  4B. High Risk               │        │
│   │      │                      │       │      │                       │        │
│   │      ├── Auto-Execute       │       │      ├── Human Escalation    │        │
│   │      │   Response Actions   │       │      │   (PagerDuty)         │        │
│   │      │                      │       │      │                       │        │
│   │      └── Log to Audit Trail │       │      └── Create Incident     │        │
│   └─────────────────────────────┘       │          (PostgreSQL)        │        │
│        │                                └─────────────────────────────┘        │
│        │                                         │                              │
│        └──────────────────┬──────────────────────┘                              │
│                           │                                                      │
│                           ▼                                                      │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  5. Response Generation                                                  │   │
│   │     │                                                                     │   │
│   │     ├── Analysis Report (JSON)                                           │   │
│   │     ├── Compliance Status                                                │   │
│   │     ├── Threat Indicators                                                │   │
│   │     └── Recommendations                                                  │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                          │
│        ▼                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  6. Monitoring & Observability                                           │   │
│   │     │                                                                     │   │
│   │     ├── Metrics ──▶ Mimir ──▶ Grafana Dashboards                         │   │
│   │     ├── Logs ──▶ Loki ──▶ Alert Rules                                    │   │
│   │     ├── Traces ──▶ Tempo ──▶ Distributed Tracing                         │   │
│   │     └── Security Events ──▶ SIEM (Splunk/ELK)                            │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                          │
│        ▼                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  7. Client Response                                                      │   │
│   │     │                                                                     │   │
│   │     ├── HTTP Response (JSON)                                             │   │
│   │     ├── WebSocket Update (Real-time)                                     │   │
│   │     └── gRPC Stream (High-performance)                                   │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## Legend

| Symbol | Meaning |
|--------|---------|
| `───▶` | Data flow |
| `├──` | Branch/component |
| `└──` | Last item |
| `┌─┐` | Component boundary |
| `[ ]` | External system |

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2025-12-01 | Initial architecture diagrams |
