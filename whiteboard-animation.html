<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QBITEL AI - Whiteboard Animation</title>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Caveat', cursive;
            background: #fafafa;
            overflow: hidden;
            height: 100vh;
        }

        /* Whiteboard Canvas */
        #whiteboard {
            width: 100vw;
            height: 100vh;
            background:
                linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            position: relative;
            overflow: hidden;
        }

        /* Drawing hand cursor */
        #hand {
            position: absolute;
            width: 80px;
            height: 80px;
            pointer-events: none;
            z-index: 1000;
            transition: transform 0.1s ease-out;
            display: none;
        }

        #hand svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }

        /* Main SVG canvas for drawing */
        #drawingCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .control-btn:hover {
            transform: scale(1.1);
        }

        .play-btn {
            background: #22c55e;
            color: white;
            width: 60px;
            height: 60px;
        }

        .pause-btn {
            background: #f59e0b;
            color: white;
        }

        .restart-btn {
            background: #3b82f6;
            color: white;
        }

        .mute-btn {
            background: #6b7280;
            color: white;
        }

        .mute-btn.muted {
            background: #ef4444;
        }

        /* Progress bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: #e5e7eb;
            z-index: 100;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.3s;
        }

        /* Scene indicator */
        .scene-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'Patrick Hand', cursive;
            font-size: 1.1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        /* Subtitle/Caption area */
        .subtitle-area {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-family: 'Patrick Hand', cursive;
            font-size: 1.4rem;
            max-width: 80%;
            text-align: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .subtitle-area.visible {
            opacity: 1;
        }

        /* Intro overlay */
        .intro-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 200;
            transition: opacity 0.5s, visibility 0.5s;
        }

        .intro-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .intro-title {
            font-size: 4rem;
            color: white;
            margin-bottom: 1rem;
        }

        .intro-subtitle {
            font-size: 1.5rem;
            color: #94a3b8;
            margin-bottom: 3rem;
            font-family: 'Patrick Hand', cursive;
        }

        .start-btn {
            padding: 20px 60px;
            font-size: 1.5rem;
            font-family: 'Caveat', cursive;
            background: #22c55e;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.4);
        }

        .sound-notice {
            margin-top: 2rem;
            color: #64748b;
            font-family: 'Patrick Hand', cursive;
            font-size: 1.1rem;
        }

        /* Drawn elements styling */
        .drawn-text {
            position: absolute;
            font-family: 'Caveat', cursive;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .drawn-text.visible {
            opacity: 1;
        }

        /* SVG drawing paths */
        .draw-path {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .draw-path.animate {
            animation: drawLine var(--duration, 1s) ease-out forwards;
        }

        @keyframes drawLine {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* Highlight effect */
        .highlight-path {
            opacity: 0;
        }

        .highlight-path.animate {
            animation: highlightIn 0.5s ease-out forwards;
        }

        @keyframes highlightIn {
            0% { opacity: 0; }
            100% { opacity: 0.4; }
        }

        /* Loading dots */
        .loading-dots {
            display: flex;
            gap: 8px;
            margin-top: 2rem;
        }

        .loading-dot {
            width: 12px;
            height: 12px;
            background: #3b82f6;
            border-radius: 50%;
            animation: loadingBounce 1.4s ease-in-out infinite;
        }

        .loading-dot:nth-child(2) { animation-delay: 0.2s; }
        .loading-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes loadingBounce {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Intro Overlay -->
    <div class="intro-overlay" id="introOverlay">
        <div class="intro-title">QBITEL AI</div>
        <div class="intro-subtitle">Whiteboard Explainer</div>
        <button class="start-btn" onclick="startAnimation()">
            â–¶ Start Presentation
        </button>
        <div class="sound-notice">ðŸ”Š Sound recommended for full experience</div>
    </div>

    <!-- Progress bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Scene indicator -->
    <div class="scene-indicator" id="sceneIndicator">Scene 1 / 12</div>

    <!-- Main whiteboard -->
    <div id="whiteboard">
        <svg id="drawingCanvas" xmlns="http://www.w3.org/2000/svg"></svg>
    </div>

    <!-- Drawing hand -->
    <div id="hand">
        <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M30 85 L35 50 L25 30 L35 25 L45 45 L45 20 L55 18 L58 42 L60 15 L70 15 L70 45 L75 25 L83 28 L78 55 L80 75 L65 90 L40 90 Z"
                  fill="#fcd5b5" stroke="#d4a574" stroke-width="2"/>
            <path d="M50 92 L55 98 L45 98 Z" fill="#2563eb" stroke="#1d4ed8" stroke-width="1"/>
        </svg>
    </div>

    <!-- Subtitle area -->
    <div class="subtitle-area" id="subtitles"></div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn restart-btn" onclick="restartAnimation()" title="Restart">ðŸ”„</button>
        <button class="control-btn play-btn" id="playPauseBtn" onclick="togglePlayPause()" title="Play/Pause">â–¶</button>
        <button class="control-btn mute-btn" id="muteBtn" onclick="toggleMute()" title="Mute/Unmute">ðŸ”Š</button>
    </div>

    <script>
        // ============================================
        // CONFIGURATION & STATE
        // ============================================
        const canvas = document.getElementById('drawingCanvas');
        const hand = document.getElementById('hand');
        const subtitles = document.getElementById('subtitles');
        const progressBar = document.getElementById('progressBar');
        const sceneIndicator = document.getElementById('sceneIndicator');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const muteBtn = document.getElementById('muteBtn');

        let isPlaying = false;
        let isMuted = false;
        let currentScene = 0;
        let animationQueue = [];
        let currentAnimation = null;
        let speechSynth = window.speechSynthesis;
        let currentUtterance = null;

        // ============================================
        // SCENE DEFINITIONS
        // ============================================
        const scenes = [
            // Scene 1: Title
            {
                name: "Introduction",
                duration: 8000,
                narration: "Welcome to QBITEL AI. Let me show you how we're revolutionizing enterprise security with one unified platform.",
                elements: [
                    { type: 'text', text: 'QBITEL AI', x: 400, y: 150, size: 72, color: '#2563eb', delay: 0 },
                    { type: 'underline', x1: 280, y1: 170, x2: 520, y2: 175, color: '#2563eb', delay: 500 },
                    { type: 'text', text: 'Unified Quantum-Safe Security', x: 400, y: 220, size: 32, color: '#6b7280', delay: 1000 },
                    { type: 'drawing', path: 'M 300 280 Q 400 320 500 280', color: '#22c55e', width: 3, delay: 1500 },
                    { type: 'icon', icon: 'ðŸ”', x: 350, y: 350, size: 60, delay: 2000 },
                    { type: 'icon', icon: 'ðŸ¤–', x: 450, y: 350, size: 60, delay: 2300 },
                ]
            },

            // Scene 2: The Problem - Tool Sprawl
            {
                name: "The Problem",
                duration: 12000,
                narration: "Here's the problem. Most companies today use 10 to 15 different security tools from different vendors. They don't talk to each other, creating dangerous blind spots.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'The Problem', x: 400, y: 80, size: 48, color: '#dc2626', delay: 200 },
                    { type: 'underline', x1: 280, y1: 100, x2: 520, y2: 105, color: '#dc2626', delay: 400 },
                    // Draw scattered security tools
                    { type: 'box', x: 100, y: 180, w: 80, h: 60, color: '#6b7280', delay: 800 },
                    { type: 'text', text: 'Tool 1', x: 140, y: 215, size: 18, color: '#374151', delay: 900 },
                    { type: 'box', x: 200, y: 260, w: 80, h: 60, color: '#6b7280', delay: 1100 },
                    { type: 'text', text: 'Tool 2', x: 240, y: 295, size: 18, color: '#374151', delay: 1200 },
                    { type: 'box', x: 120, y: 340, w: 80, h: 60, color: '#6b7280', delay: 1400 },
                    { type: 'text', text: 'Tool 3', x: 160, y: 375, size: 18, color: '#374151', delay: 1500 },
                    { type: 'box', x: 300, y: 180, w: 80, h: 60, color: '#6b7280', delay: 1700 },
                    { type: 'text', text: 'Tool 4', x: 340, y: 215, size: 18, color: '#374151', delay: 1800 },
                    { type: 'box', x: 320, y: 320, w: 80, h: 60, color: '#6b7280', delay: 2000 },
                    { type: 'text', text: 'Tool 5', x: 360, y: 355, size: 18, color: '#374151', delay: 2100 },
                    // X marks showing disconnect
                    { type: 'drawing', path: 'M 185 230 L 210 270', color: '#dc2626', width: 3, delay: 2500 },
                    { type: 'drawing', path: 'M 210 230 L 185 270', color: '#dc2626', width: 3, delay: 2600 },
                    { type: 'drawing', path: 'M 285 250 L 310 290', color: '#dc2626', width: 3, delay: 2800 },
                    { type: 'drawing', path: 'M 310 250 L 285 290', color: '#dc2626', width: 3, delay: 2900 },
                    // Big number
                    { type: 'text', text: '10-15', x: 600, y: 250, size: 72, color: '#dc2626', delay: 3500 },
                    { type: 'text', text: 'security tools', x: 600, y: 300, size: 28, color: '#6b7280', delay: 3800 },
                    { type: 'text', text: "that DON'T talk!", x: 600, y: 340, size: 24, color: '#dc2626', delay: 4200 },
                    { type: 'highlight', x: 550, y: 200, w: 150, h: 160, color: '#fef08a', delay: 4500 },
                ]
            },

            // Scene 3: The Cost Problem
            {
                name: "The Cost Problem",
                duration: 14000,
                narration: "And here's the nightmare. Banks and enterprises run on 30-year-old systems processing billions daily. Traditional replacement costs 100 million to 1 billion dollars, takes 3 to 5 years, and fails 60% of the time!",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'The Billion Dollar Nightmare', x: 400, y: 80, size: 42, color: '#dc2626', delay: 200 },
                    // Old system drawing
                    { type: 'box', x: 100, y: 180, w: 150, h: 120, color: '#6b7280', delay: 600 },
                    { type: 'text', text: '30-year old', x: 175, y: 230, size: 20, color: '#374151', delay: 800 },
                    { type: 'text', text: 'Mainframe', x: 175, y: 260, size: 22, color: '#374151', delay: 900 },
                    { type: 'text', text: '$50B/day', x: 175, y: 290, size: 18, color: '#059669', delay: 1100 },
                    // Arrow
                    { type: 'drawing', path: 'M 260 240 L 350 240', color: '#374151', width: 3, delay: 1500 },
                    { type: 'drawing', path: 'M 340 230 L 355 240 L 340 250', color: '#374151', width: 3, delay: 1700 },
                    // Traditional approach
                    { type: 'text', text: 'Traditional', x: 480, y: 170, size: 28, color: '#dc2626', delay: 2000 },
                    { type: 'text', text: 'Approach:', x: 480, y: 200, size: 28, color: '#dc2626', delay: 2100 },
                    { type: 'text', text: '$100M - $1B', x: 480, y: 250, size: 36, color: '#dc2626', delay: 2500 },
                    { type: 'text', text: '3-5 years', x: 480, y: 290, size: 28, color: '#6b7280', delay: 2900 },
                    // Strikethrough
                    { type: 'drawing', path: 'M 380 250 L 580 250', color: '#dc2626', width: 4, delay: 3300 },
                    // Failure rate
                    { type: 'circle', x: 620, y: 380, r: 60, color: '#dc2626', delay: 3800 },
                    { type: 'text', text: '60%', x: 620, y: 375, size: 36, color: '#dc2626', delay: 4200 },
                    { type: 'text', text: 'FAIL!', x: 620, y: 410, size: 24, color: '#dc2626', delay: 4400 },
                    // Question
                    { type: 'text', text: 'What if there was a better way?', x: 200, y: 450, size: 28, color: '#2563eb', delay: 5500 },
                    { type: 'drawing', path: 'M 100 460 Q 200 480 400 455', color: '#2563eb', width: 2, delay: 6000 },
                ]
            },

            // Scene 4: Enter QBITEL
            {
                name: "The Solution",
                duration: 12000,
                narration: "Enter QBITEL AI. We work like a protective wrapper around your existing systems. No code changes. No downtime. Done in 90 days, not 5 years. 90% cheaper.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'The Solution: QBITEL AI', x: 400, y: 80, size: 42, color: '#2563eb', delay: 200 },
                    // Central circle
                    { type: 'circle', x: 400, y: 300, r: 80, color: '#2563eb', delay: 600 },
                    { type: 'text', text: 'QBITEL', x: 400, y: 295, size: 28, color: '#2563eb', delay: 1000 },
                    { type: 'text', text: 'AI', x: 400, y: 325, size: 24, color: '#2563eb', delay: 1100 },
                    // Outer protective ring
                    { type: 'circle', x: 400, y: 300, r: 120, color: '#22c55e', delay: 1400 },
                    { type: 'text', text: 'Protective Shield', x: 400, y: 180, size: 20, color: '#22c55e', delay: 1700 },
                    // Connected systems
                    { type: 'icon', icon: 'ðŸ¦', x: 200, y: 200, size: 40, delay: 2000 },
                    { type: 'drawing', path: 'M 230 220 L 310 260', color: '#94a3b8', width: 2, delay: 2100 },
                    { type: 'icon', icon: 'â˜ï¸', x: 550, y: 200, size: 40, delay: 2300 },
                    { type: 'drawing', path: 'M 530 220 L 480 260', color: '#94a3b8', width: 2, delay: 2400 },
                    { type: 'icon', icon: 'ðŸ¥', x: 200, y: 380, size: 40, delay: 2600 },
                    { type: 'drawing', path: 'M 230 380 L 310 340', color: '#94a3b8', width: 2, delay: 2700 },
                    { type: 'icon', icon: 'âš¡', x: 550, y: 380, size: 40, delay: 2900 },
                    { type: 'drawing', path: 'M 530 380 L 480 340', color: '#94a3b8', width: 2, delay: 3000 },
                    // Benefits
                    { type: 'text', text: 'âœ“ No code changes', x: 680, y: 250, size: 22, color: '#22c55e', delay: 3500 },
                    { type: 'text', text: 'âœ“ Zero downtime', x: 680, y: 290, size: 22, color: '#22c55e', delay: 3800 },
                    { type: 'text', text: 'âœ“ 90 days', x: 680, y: 330, size: 22, color: '#22c55e', delay: 4100 },
                    { type: 'text', text: 'âœ“ 90% cheaper', x: 680, y: 370, size: 22, color: '#22c55e', delay: 4400 },
                    { type: 'highlight', x: 620, y: 230, w: 160, h: 160, color: '#bbf7d0', delay: 4800 },
                ]
            },

            // Scene 5: Three Superpowers
            {
                name: "Three Superpowers",
                duration: 16000,
                narration: "QBITEL AI has three superpowers. First, our AI discovers how any system communicates in 2 to 4 hours, not 6 to 12 months. Second, we use the highest level quantum-safe encryption. Third, our AI handles 78% of security decisions automatically.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Three Superpowers', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Power 1
                    { type: 'circle', x: 150, y: 220, r: 50, color: '#3b82f6', delay: 600 },
                    { type: 'text', text: '01', x: 150, y: 225, size: 36, color: '#3b82f6', delay: 800 },
                    { type: 'text', text: 'Lightning Discovery', x: 150, y: 290, size: 22, color: '#1f2937', delay: 1000 },
                    { type: 'text', text: '2-4 hours', x: 150, y: 320, size: 28, color: '#22c55e', delay: 1300 },
                    { type: 'text', text: 'vs 6-12 months', x: 150, y: 350, size: 18, color: '#6b7280', delay: 1500 },
                    { type: 'icon', icon: 'âš¡', x: 150, y: 400, size: 40, delay: 1800 },
                    // Power 2
                    { type: 'circle', x: 400, y: 220, r: 50, color: '#8b5cf6', delay: 2200 },
                    { type: 'text', text: '02', x: 400, y: 225, size: 36, color: '#8b5cf6', delay: 2400 },
                    { type: 'text', text: 'Quantum-Safe', x: 400, y: 290, size: 22, color: '#1f2937', delay: 2600 },
                    { type: 'text', text: 'NIST Level 5', x: 400, y: 320, size: 28, color: '#8b5cf6', delay: 2900 },
                    { type: 'text', text: 'Future-proof', x: 400, y: 350, size: 18, color: '#6b7280', delay: 3100 },
                    { type: 'icon', icon: 'ðŸ”', x: 400, y: 400, size: 40, delay: 3400 },
                    // Power 3
                    { type: 'circle', x: 650, y: 220, r: 50, color: '#22c55e', delay: 3800 },
                    { type: 'text', text: '03', x: 650, y: 225, size: 36, color: '#22c55e', delay: 4000 },
                    { type: 'text', text: 'Autonomous AI', x: 650, y: 290, size: 22, color: '#1f2937', delay: 4200 },
                    { type: 'text', text: '78%', x: 650, y: 330, size: 42, color: '#22c55e', delay: 4500 },
                    { type: 'text', text: 'auto decisions', x: 650, y: 365, size: 18, color: '#6b7280', delay: 4700 },
                    { type: 'icon', icon: 'ðŸ¤–', x: 650, y: 410, size: 40, delay: 5000 },
                    // Connecting line
                    { type: 'drawing', path: 'M 200 220 L 350 220', color: '#e5e7eb', width: 3, delay: 5400 },
                    { type: 'drawing', path: 'M 450 220 L 600 220', color: '#e5e7eb', width: 3, delay: 5600 },
                ]
            },

            // Scene 6: Quantum Threat
            {
                name: "Quantum Threat",
                duration: 14000,
                narration: "Here's why this matters NOW. Quantum computers will break today's encryption by 2030. But here's the scary part: hackers are already stealing encrypted data today, planning to decrypt it later. It's called harvest now, decrypt later.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'âš ï¸ The Quantum Threat', x: 400, y: 70, size: 42, color: '#dc2626', delay: 200 },
                    // Timeline
                    { type: 'drawing', path: 'M 100 250 L 700 250', color: '#374151', width: 4, delay: 600 },
                    // Today
                    { type: 'circle', x: 150, y: 250, r: 15, color: '#f59e0b', delay: 1000 },
                    { type: 'text', text: 'TODAY', x: 150, y: 290, size: 20, color: '#f59e0b', delay: 1200 },
                    { type: 'text', text: 'Hackers stealing', x: 150, y: 320, size: 16, color: '#6b7280', delay: 1400 },
                    { type: 'text', text: 'encrypted data', x: 150, y: 340, size: 16, color: '#6b7280', delay: 1500 },
                    // 2027
                    { type: 'circle', x: 400, y: 250, r: 15, color: '#6b7280', delay: 1800 },
                    { type: 'text', text: '2027', x: 400, y: 290, size: 20, color: '#6b7280', delay: 2000 },
                    { type: 'text', text: 'Quantum getting', x: 400, y: 320, size: 16, color: '#6b7280', delay: 2200 },
                    { type: 'text', text: 'powerful', x: 400, y: 340, size: 16, color: '#6b7280', delay: 2300 },
                    // 2030
                    { type: 'circle', x: 650, y: 250, r: 20, color: '#dc2626', delay: 2600 },
                    { type: 'text', text: '2030', x: 650, y: 295, size: 24, color: '#dc2626', delay: 2800 },
                    { type: 'text', text: 'NSA DEADLINE', x: 650, y: 330, size: 18, color: '#dc2626', delay: 3000 },
                    { type: 'icon', icon: 'ðŸ’€', x: 650, y: 370, size: 30, delay: 3200 },
                    // Warning box
                    { type: 'box', x: 150, y: 400, w: 500, h: 80, color: '#dc2626', delay: 3800 },
                    { type: 'text', text: '"Harvest Now, Decrypt Later"', x: 400, y: 430, size: 28, color: '#dc2626', delay: 4200 },
                    { type: 'text', text: 'Your data stolen TODAY â†’ decrypted in 2030!', x: 400, y: 465, size: 20, color: '#991b1b', delay: 4600 },
                    // Dollar amount
                    { type: 'text', text: '$8.3 TRILLION', x: 400, y: 540, size: 36, color: '#dc2626', delay: 5200 },
                    { type: 'text', text: 'at risk', x: 400, y: 575, size: 24, color: '#6b7280', delay: 5500 },
                ]
            },

            // Scene 7: How It Works
            {
                name: "How It Works",
                duration: 16000,
                narration: "So how does it work? Step 1: We connect to your network passively. No agents needed. Step 2: Our AI watches and learns how everything communicates. Step 3: We wrap your systems in quantum-safe encryption. Step 4: AI handles security automatically. Done!",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'How It Works', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Step 1
                    { type: 'circle', x: 100, y: 200, r: 35, color: '#3b82f6', delay: 600 },
                    { type: 'text', text: '1', x: 100, y: 205, size: 32, color: '#3b82f6', delay: 700 },
                    { type: 'text', text: 'CONNECT', x: 100, y: 260, size: 20, color: '#1f2937', delay: 900 },
                    { type: 'text', text: 'Plug in passively', x: 100, y: 285, size: 16, color: '#6b7280', delay: 1100 },
                    { type: 'drawing', path: 'M 145 200 L 220 200', color: '#22c55e', width: 3, delay: 1400 },
                    { type: 'drawing', path: 'M 210 190 L 225 200 L 210 210', color: '#22c55e', width: 3, delay: 1500 },
                    // Step 2
                    { type: 'circle', x: 300, y: 200, r: 35, color: '#8b5cf6', delay: 1800 },
                    { type: 'text', text: '2', x: 300, y: 205, size: 32, color: '#8b5cf6', delay: 1900 },
                    { type: 'text', text: 'LEARN', x: 300, y: 260, size: 20, color: '#1f2937', delay: 2100 },
                    { type: 'text', text: 'AI watches traffic', x: 300, y: 285, size: 16, color: '#6b7280', delay: 2300 },
                    { type: 'text', text: '2-4 hours!', x: 300, y: 305, size: 16, color: '#22c55e', delay: 2500 },
                    { type: 'drawing', path: 'M 345 200 L 420 200', color: '#22c55e', width: 3, delay: 2800 },
                    { type: 'drawing', path: 'M 410 190 L 425 200 L 410 210', color: '#22c55e', width: 3, delay: 2900 },
                    // Step 3
                    { type: 'circle', x: 500, y: 200, r: 35, color: '#f59e0b', delay: 3200 },
                    { type: 'text', text: '3', x: 500, y: 205, size: 32, color: '#f59e0b', delay: 3300 },
                    { type: 'text', text: 'WRAP', x: 500, y: 260, size: 20, color: '#1f2937', delay: 3500 },
                    { type: 'text', text: 'Quantum-safe', x: 500, y: 285, size: 16, color: '#6b7280', delay: 3700 },
                    { type: 'text', text: 'encryption', x: 500, y: 305, size: 16, color: '#6b7280', delay: 3800 },
                    { type: 'drawing', path: 'M 545 200 L 620 200', color: '#22c55e', width: 3, delay: 4100 },
                    { type: 'drawing', path: 'M 610 190 L 625 200 L 610 210', color: '#22c55e', width: 3, delay: 4200 },
                    // Step 4
                    { type: 'circle', x: 700, y: 200, r: 35, color: '#22c55e', delay: 4500 },
                    { type: 'text', text: '4', x: 700, y: 205, size: 32, color: '#22c55e', delay: 4600 },
                    { type: 'text', text: 'PROTECT', x: 700, y: 260, size: 20, color: '#1f2937', delay: 4800 },
                    { type: 'text', text: '78% autonomous', x: 700, y: 285, size: 16, color: '#6b7280', delay: 5000 },
                    // Result
                    { type: 'box', x: 300, y: 380, w: 200, h: 80, color: '#22c55e', delay: 5500 },
                    { type: 'text', text: 'âœ“ DONE!', x: 400, y: 410, size: 32, color: '#22c55e', delay: 5800 },
                    { type: 'text', text: '90 days, not 5 years', x: 400, y: 445, size: 20, color: '#166534', delay: 6100 },
                ]
            },

            // Scene 8: Industries
            {
                name: "Industries We Serve",
                duration: 14000,
                narration: "Who needs this? Banks processing trillions in transactions. Critical infrastructure that can never go down. Hospitals with devices they can't modify. Government agencies facing quantum mandates. Telecom managing billions of devices.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Who Needs QBITEL AI?', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Banking
                    { type: 'icon', icon: 'ðŸ¦', x: 150, y: 180, size: 50, delay: 600 },
                    { type: 'text', text: 'Banking', x: 150, y: 250, size: 24, color: '#1f2937', delay: 800 },
                    { type: 'text', text: '$300-400M', x: 150, y: 280, size: 20, color: '#3b82f6', delay: 1000 },
                    // Energy
                    { type: 'icon', icon: 'âš¡', x: 400, y: 180, size: 50, delay: 1300 },
                    { type: 'text', text: 'Energy', x: 400, y: 250, size: 24, color: '#1f2937', delay: 1500 },
                    { type: 'text', text: '$200-300M', x: 400, y: 280, size: 20, color: '#f59e0b', delay: 1700 },
                    // Healthcare
                    { type: 'icon', icon: 'ðŸ¥', x: 650, y: 180, size: 50, delay: 2000 },
                    { type: 'text', text: 'Healthcare', x: 650, y: 250, size: 24, color: '#1f2937', delay: 2200 },
                    { type: 'text', text: '$200-300M', x: 650, y: 280, size: 20, color: '#22c55e', delay: 2400 },
                    // Government
                    { type: 'icon', icon: 'ðŸ›ï¸', x: 250, y: 360, size: 50, delay: 2700 },
                    { type: 'text', text: 'Government', x: 250, y: 430, size: 24, color: '#1f2937', delay: 2900 },
                    { type: 'text', text: '$100-200M', x: 250, y: 460, size: 20, color: '#8b5cf6', delay: 3100 },
                    // Telecom
                    { type: 'icon', icon: 'ðŸ“¡', x: 550, y: 360, size: 50, delay: 3400 },
                    { type: 'text', text: 'Telecom', x: 550, y: 430, size: 24, color: '#1f2937', delay: 3600 },
                    { type: 'text', text: '$150-250M', x: 550, y: 460, size: 20, color: '#dc2626', delay: 3800 },
                    // Total
                    { type: 'drawing', path: 'M 100 520 L 700 520', color: '#374151', width: 2, delay: 4200 },
                    { type: 'text', text: 'Total Market:', x: 300, y: 560, size: 24, color: '#6b7280', delay: 4500 },
                    { type: 'text', text: '$1.0 - 1.5 BILLION', x: 550, y: 560, size: 28, color: '#2563eb', delay: 4800 },
                ]
            },

            // Scene 9: Business Model
            {
                name: "Business Model",
                duration: 12000,
                narration: "Our business model is simple. Enterprise subscription at $650,000 per year for the base platform. Add-on AI features for another $180,000. Professional services for integration. Customers expand as they add more protocols and sites.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Business Model', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Base Platform
                    { type: 'box', x: 100, y: 150, w: 200, h: 120, color: '#3b82f6', delay: 600 },
                    { type: 'text', text: 'Base Platform', x: 200, y: 190, size: 22, color: '#3b82f6', delay: 800 },
                    { type: 'text', text: '$650K/yr', x: 200, y: 230, size: 28, color: '#1e40af', delay: 1000 },
                    { type: 'text', text: 'per site', x: 200, y: 260, size: 16, color: '#6b7280', delay: 1100 },
                    // Add-ons
                    { type: 'box', x: 350, y: 150, w: 200, h: 120, color: '#8b5cf6', delay: 1400 },
                    { type: 'text', text: 'AI Add-ons', x: 450, y: 190, size: 22, color: '#8b5cf6', delay: 1600 },
                    { type: 'text', text: '+$180K/yr', x: 450, y: 230, size: 28, color: '#6d28d9', delay: 1800 },
                    { type: 'text', text: 'copilots & automation', x: 450, y: 260, size: 14, color: '#6b7280', delay: 1900 },
                    // Services
                    { type: 'box', x: 600, y: 150, w: 180, h: 120, color: '#22c55e', delay: 2200 },
                    { type: 'text', text: 'Services', x: 690, y: 190, size: 22, color: '#22c55e', delay: 2400 },
                    { type: 'text', text: '$250K', x: 690, y: 230, size: 28, color: '#166534', delay: 2600 },
                    { type: 'text', text: 'one-time', x: 690, y: 260, size: 16, color: '#6b7280', delay: 2700 },
                    // Expansion arrow
                    { type: 'drawing', path: 'M 200 300 L 200 380 L 600 380 L 600 300', color: '#f59e0b', width: 3, delay: 3200 },
                    { type: 'text', text: 'EXPANSION: More protocols + More sites = More $$$', x: 400, y: 420, size: 22, color: '#f59e0b', delay: 3600 },
                    // Net retention
                    { type: 'text', text: '130%+', x: 400, y: 500, size: 48, color: '#22c55e', delay: 4200 },
                    { type: 'text', text: 'Net Revenue Retention', x: 400, y: 545, size: 24, color: '#6b7280', delay: 4500 },
                ]
            },

            // Scene 10: Roadmap
            {
                name: "Growth Roadmap",
                duration: 12000,
                narration: "Our roadmap: Year 1, we target 6 customers and 5 million in annual recurring revenue. Year 2, we expand to 16 customers and 15 million. Year 3, we scale to 32 customers and over 30 million ARR.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Growth Roadmap', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Timeline base
                    { type: 'drawing', path: 'M 100 300 L 700 300', color: '#e5e7eb', width: 6, delay: 500 },
                    // Year 1
                    { type: 'circle', x: 200, y: 300, r: 40, color: '#22c55e', delay: 900 },
                    { type: 'text', text: 'Y1', x: 200, y: 305, size: 28, color: '#22c55e', delay: 1100 },
                    { type: 'text', text: '6 customers', x: 200, y: 380, size: 20, color: '#1f2937', delay: 1300 },
                    { type: 'text', text: '$5M ARR', x: 200, y: 410, size: 24, color: '#22c55e', delay: 1500 },
                    // Year 2
                    { type: 'circle', x: 400, y: 300, r: 40, color: '#3b82f6', delay: 1900 },
                    { type: 'text', text: 'Y2', x: 400, y: 305, size: 28, color: '#3b82f6', delay: 2100 },
                    { type: 'text', text: '16 customers', x: 400, y: 380, size: 20, color: '#1f2937', delay: 2300 },
                    { type: 'text', text: '$15M ARR', x: 400, y: 410, size: 24, color: '#3b82f6', delay: 2500 },
                    // Year 3
                    { type: 'circle', x: 600, y: 300, r: 45, color: '#8b5cf6', delay: 2900 },
                    { type: 'text', text: 'Y3', x: 600, y: 305, size: 28, color: '#8b5cf6', delay: 3100 },
                    { type: 'text', text: '32 customers', x: 600, y: 385, size: 20, color: '#1f2937', delay: 3300 },
                    { type: 'text', text: '$30M+ ARR', x: 600, y: 415, size: 26, color: '#8b5cf6', delay: 3500 },
                    // Growth arrow
                    { type: 'drawing', path: 'M 150 200 Q 400 100 650 200', color: '#22c55e', width: 4, delay: 4000 },
                    { type: 'drawing', path: 'M 640 180 L 655 200 L 635 210', color: '#22c55e', width: 4, delay: 4200 },
                    { type: 'icon', icon: 'ðŸš€', x: 680, y: 150, size: 40, delay: 4500 },
                ]
            },

            // Scene 11: Why Us
            {
                name: "Why QBITEL",
                duration: 12000,
                narration: "Why can't the big players just copy this? Because we're the only platform combining AI protocol discovery, quantum cryptography, security automation, AND compliance in one. Plus, our AI runs completely on-premise. No data ever leaves your network.",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Why Can\'t They Copy Us?', x: 400, y: 70, size: 42, color: '#2563eb', delay: 200 },
                    // Competitive moat visualization
                    { type: 'circle', x: 400, y: 320, r: 60, color: '#2563eb', delay: 600 },
                    { type: 'text', text: 'QBITEL', x: 400, y: 315, size: 22, color: '#2563eb', delay: 800 },
                    { type: 'text', text: 'AI', x: 400, y: 340, size: 18, color: '#2563eb', delay: 900 },
                    // Moat ring
                    { type: 'circle', x: 400, y: 320, r: 120, color: '#22c55e', delay: 1200 },
                    // Advantages around
                    { type: 'text', text: 'ðŸ” AI Discovery', x: 200, y: 200, size: 20, color: '#1f2937', delay: 1600 },
                    { type: 'drawing', path: 'M 260 210 L 320 270', color: '#94a3b8', width: 2, delay: 1700 },
                    { type: 'text', text: 'ðŸ” Quantum Crypto', x: 600, y: 200, size: 20, color: '#1f2937', delay: 2000 },
                    { type: 'drawing', path: 'M 540 210 L 480 270', color: '#94a3b8', width: 2, delay: 2100 },
                    { type: 'text', text: 'ðŸ¤– Auto Security', x: 200, y: 440, size: 20, color: '#1f2937', delay: 2400 },
                    { type: 'drawing', path: 'M 260 430 L 320 380', color: '#94a3b8', width: 2, delay: 2500 },
                    { type: 'text', text: 'ðŸ“‹ Compliance', x: 600, y: 440, size: 20, color: '#1f2937', delay: 2800 },
                    { type: 'drawing', path: 'M 540 430 L 480 380', color: '#94a3b8', width: 2, delay: 2900 },
                    // Key differentiator
                    { type: 'box', x: 250, y: 500, w: 300, h: 60, color: '#dc2626', delay: 3400 },
                    { type: 'text', text: '100% ON-PREMISE AI', x: 400, y: 525, size: 24, color: '#dc2626', delay: 3700 },
                    { type: 'text', text: 'Your data NEVER leaves your network', x: 400, y: 555, size: 18, color: '#991b1b', delay: 4000 },
                ]
            },

            // Scene 12: Call to Action
            {
                name: "Get Started",
                duration: 10000,
                narration: "Ready to secure your future? Start with a 90-day proof of concept. See the results yourself. Let's build a quantum-safe future together. Thank you for watching!",
                elements: [
                    { type: 'clear', delay: 0 },
                    { type: 'text', text: 'Ready to Get Started?', x: 400, y: 100, size: 48, color: '#2563eb', delay: 200 },
                    // POC offer
                    { type: 'box', x: 200, y: 180, w: 400, h: 100, color: '#22c55e', delay: 800 },
                    { type: 'text', text: '90-Day Proof of Concept', x: 400, y: 215, size: 28, color: '#22c55e', delay: 1000 },
                    { type: 'text', text: '$50-100K to see it work', x: 400, y: 255, size: 22, color: '#166534', delay: 1200 },
                    // Benefits
                    { type: 'text', text: 'âœ“ Zero risk', x: 250, y: 340, size: 24, color: '#22c55e', delay: 1600 },
                    { type: 'text', text: 'âœ“ Real results', x: 400, y: 340, size: 24, color: '#22c55e', delay: 1900 },
                    { type: 'text', text: 'âœ“ 90 days', x: 550, y: 340, size: 24, color: '#22c55e', delay: 2200 },
                    // CTA button
                    { type: 'box', x: 250, y: 400, w: 300, h: 70, color: '#2563eb', delay: 2800 },
                    { type: 'text', text: 'Schedule a Demo â†’', x: 400, y: 440, size: 28, color: '#2563eb', delay: 3100 },
                    // Thank you
                    { type: 'text', text: 'Thank You! ðŸ™', x: 400, y: 540, size: 42, color: '#1f2937', delay: 3800 },
                    { type: 'drawing', path: 'M 200 560 Q 400 600 600 560', color: '#22c55e', width: 3, delay: 4200 },
                    // Logo
                    { type: 'text', text: 'QBITEL AI', x: 700, y: 560, size: 24, color: '#3b82f6', delay: 4600 },
                ]
            }
        ];

        // ============================================
        // DRAWING FUNCTIONS
        // ============================================

        function clearCanvas() {
            canvas.innerHTML = '';
        }

        function moveHand(x, y, duration = 500) {
            return new Promise(resolve => {
                hand.style.display = 'block';
                hand.style.transition = `left ${duration}ms ease-out, top ${duration}ms ease-out`;
                hand.style.left = (x - 20) + 'px';
                hand.style.top = (y - 60) + 'px';
                setTimeout(resolve, duration);
            });
        }

        function hideHand() {
            hand.style.display = 'none';
        }

        function drawPath(pathData, color, strokeWidth, duration = 1000) {
            return new Promise(resolve => {
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('stroke', color);
                path.setAttribute('stroke-width', strokeWidth);
                path.setAttribute('fill', 'none');
                path.setAttribute('stroke-linecap', 'round');
                path.setAttribute('stroke-linejoin', 'round');

                // Calculate path length for animation
                canvas.appendChild(path);
                const length = path.getTotalLength();

                path.style.strokeDasharray = length;
                path.style.strokeDashoffset = length;
                path.style.transition = `stroke-dashoffset ${duration}ms ease-out`;

                // Trigger animation
                requestAnimationFrame(() => {
                    path.style.strokeDashoffset = '0';
                });

                setTimeout(resolve, duration);
            });
        }

        function drawText(text, x, y, size, color) {
            return new Promise(resolve => {
                const textEl = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textEl.setAttribute('x', x);
                textEl.setAttribute('y', y);
                textEl.setAttribute('text-anchor', 'middle');
                textEl.setAttribute('font-family', 'Caveat, cursive');
                textEl.setAttribute('font-size', size);
                textEl.setAttribute('fill', color);
                textEl.textContent = text;
                textEl.style.opacity = '0';
                textEl.style.transition = 'opacity 0.3s ease-out';

                canvas.appendChild(textEl);

                requestAnimationFrame(() => {
                    textEl.style.opacity = '1';
                });

                setTimeout(resolve, 300);
            });
        }

        function drawBox(x, y, w, h, color) {
            return new Promise(resolve => {
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', w);
                rect.setAttribute('height', h);
                rect.setAttribute('fill', 'none');
                rect.setAttribute('stroke', color);
                rect.setAttribute('stroke-width', '3');
                rect.setAttribute('rx', '8');

                const perimeter = 2 * (w + h);
                rect.style.strokeDasharray = perimeter;
                rect.style.strokeDashoffset = perimeter;
                rect.style.transition = 'stroke-dashoffset 0.8s ease-out';

                canvas.appendChild(rect);

                requestAnimationFrame(() => {
                    rect.style.strokeDashoffset = '0';
                });

                setTimeout(resolve, 800);
            });
        }

        function drawCircle(x, y, r, color) {
            return new Promise(resolve => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('r', r);
                circle.setAttribute('fill', 'none');
                circle.setAttribute('stroke', color);
                circle.setAttribute('stroke-width', '3');

                const circumference = 2 * Math.PI * r;
                circle.style.strokeDasharray = circumference;
                circle.style.strokeDashoffset = circumference;
                circle.style.transition = 'stroke-dashoffset 0.6s ease-out';

                canvas.appendChild(circle);

                requestAnimationFrame(() => {
                    circle.style.strokeDashoffset = '0';
                });

                setTimeout(resolve, 600);
            });
        }

        function drawIcon(icon, x, y, size) {
            return new Promise(resolve => {
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', x);
                text.setAttribute('y', y);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('dominant-baseline', 'middle');
                text.setAttribute('font-size', size);
                text.textContent = icon;
                text.style.opacity = '0';
                text.style.transform = 'scale(0)';
                text.style.transformOrigin = `${x}px ${y}px`;
                text.style.transition = 'opacity 0.3s, transform 0.3s ease-out';

                canvas.appendChild(text);

                requestAnimationFrame(() => {
                    text.style.opacity = '1';
                    text.style.transform = 'scale(1)';
                });

                setTimeout(resolve, 300);
            });
        }

        function drawHighlight(x, y, w, h, color) {
            return new Promise(resolve => {
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', w);
                rect.setAttribute('height', h);
                rect.setAttribute('fill', color);
                rect.setAttribute('rx', '4');
                rect.style.opacity = '0';
                rect.style.transition = 'opacity 0.5s ease-out';

                // Insert at beginning so it's behind other elements
                canvas.insertBefore(rect, canvas.firstChild);

                requestAnimationFrame(() => {
                    rect.style.opacity = '0.4';
                });

                setTimeout(resolve, 500);
            });
        }

        function drawUnderline(x1, y1, x2, y2, color) {
            const pathData = `M ${x1} ${y1} L ${x2} ${y2}`;
            return drawPath(pathData, color, 4, 500);
        }

        // ============================================
        // SPEECH SYNTHESIS
        // ============================================

        function speak(text) {
            return new Promise(resolve => {
                if (isMuted || !speechSynth) {
                    // If muted, just wait for estimated duration
                    const duration = text.length * 60; // Rough estimate
                    setTimeout(resolve, duration);
                    return;
                }

                // Cancel any ongoing speech
                speechSynth.cancel();

                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1;
                utterance.volume = 1;

                // Try to get a good English voice
                const voices = speechSynth.getVoices();
                const englishVoice = voices.find(v => v.lang.startsWith('en') && v.name.includes('Google')) ||
                                    voices.find(v => v.lang.startsWith('en-US')) ||
                                    voices.find(v => v.lang.startsWith('en'));
                if (englishVoice) {
                    utterance.voice = englishVoice;
                }

                utterance.onend = () => resolve();
                utterance.onerror = () => resolve();

                currentUtterance = utterance;
                speechSynth.speak(utterance);
            });
        }

        // ============================================
        // SCENE PLAYBACK
        // ============================================

        async function playElement(element) {
            if (!isPlaying) return;

            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const offsetX = centerX - 400;
            const offsetY = centerY - 300;

            switch (element.type) {
                case 'clear':
                    clearCanvas();
                    hideHand();
                    break;

                case 'text':
                    await moveHand(element.x + offsetX, element.y + offsetY, 300);
                    await drawText(element.text, element.x + offsetX, element.y + offsetY, element.size, element.color);
                    break;

                case 'drawing':
                    // Adjust path coordinates
                    const adjustedPath = element.path.replace(/(\d+)/g, (match, num, offset, string) => {
                        // Check if this is an X or Y coordinate based on position
                        const before = string.substring(0, offset);
                        const isY = (before.match(/[MLQCSTAmlqcsta,]\s*-?\d+\s*$/)) !== null;
                        return isY ? (parseFloat(num) + offsetY) : (parseFloat(num) + offsetX);
                    });

                    // Simple offset for path
                    const pathParts = element.path.split(/([MLQCSTAmlqcsta])/);
                    let newPath = '';
                    let isX = true;
                    for (let i = 0; i < pathParts.length; i++) {
                        const part = pathParts[i].trim();
                        if (/^[MLQCSTAmlqcsta]$/.test(part)) {
                            newPath += part + ' ';
                            isX = true;
                        } else if (part) {
                            const nums = part.trim().split(/\s+/);
                            for (let n of nums) {
                                if (n) {
                                    const num = parseFloat(n);
                                    if (!isNaN(num)) {
                                        newPath += (isX ? num + offsetX : num + offsetY) + ' ';
                                        isX = !isX;
                                    }
                                }
                            }
                        }
                    }

                    await moveHand(element.x1 ? element.x1 + offsetX : offsetX + 400, element.y1 ? element.y1 + offsetY : offsetY + 300, 200);
                    await drawPath(newPath.trim(), element.color, element.width);
                    break;

                case 'box':
                    await moveHand(element.x + offsetX, element.y + offsetY, 300);
                    await drawBox(element.x + offsetX, element.y + offsetY, element.w, element.h, element.color);
                    break;

                case 'circle':
                    await moveHand(element.x + offsetX, element.y + offsetY - element.r, 300);
                    await drawCircle(element.x + offsetX, element.y + offsetY, element.r, element.color);
                    break;

                case 'icon':
                    await moveHand(element.x + offsetX, element.y + offsetY, 200);
                    await drawIcon(element.icon, element.x + offsetX, element.y + offsetY, element.size);
                    break;

                case 'highlight':
                    await drawHighlight(element.x + offsetX, element.y + offsetY, element.w, element.h, element.color);
                    break;

                case 'underline':
                    await moveHand(element.x1 + offsetX, element.y1 + offsetY, 200);
                    await drawUnderline(element.x1 + offsetX, element.y1 + offsetY, element.x2 + offsetX, element.y2 + offsetY, element.color);
                    break;
            }
        }

        async function playScene(sceneIndex) {
            if (sceneIndex >= scenes.length || !isPlaying) return;

            currentScene = sceneIndex;
            const scene = scenes[sceneIndex];

            // Update UI
            sceneIndicator.textContent = `Scene ${sceneIndex + 1} / ${scenes.length}`;
            progressBar.style.width = ((sceneIndex + 1) / scenes.length * 100) + '%';

            // Show subtitles and start narration
            subtitles.textContent = scene.narration;
            subtitles.classList.add('visible');

            // Start speech
            const speechPromise = speak(scene.narration);

            // Sort elements by delay
            const sortedElements = [...scene.elements].sort((a, b) => (a.delay || 0) - (b.delay || 0));

            // Play elements with their delays
            let lastDelay = 0;
            for (const element of sortedElements) {
                if (!isPlaying) break;

                const waitTime = (element.delay || 0) - lastDelay;
                if (waitTime > 0) {
                    await new Promise(r => setTimeout(r, waitTime));
                }
                lastDelay = element.delay || 0;

                await playElement(element);
            }

            // Wait for speech to finish
            await speechPromise;

            // Small pause between scenes
            await new Promise(r => setTimeout(r, 1000));

            subtitles.classList.remove('visible');
            hideHand();

            // Play next scene
            if (isPlaying && sceneIndex < scenes.length - 1) {
                await playScene(sceneIndex + 1);
            } else if (sceneIndex >= scenes.length - 1) {
                isPlaying = false;
                playPauseBtn.textContent = 'â–¶';
            }
        }

        // ============================================
        // CONTROLS
        // ============================================

        function startAnimation() {
            document.getElementById('introOverlay').classList.add('hidden');
            isPlaying = true;
            playPauseBtn.textContent = 'â¸';

            // Load voices (needed for some browsers)
            if (speechSynth) {
                speechSynth.getVoices();
            }

            playScene(0);
        }

        function togglePlayPause() {
            if (isPlaying) {
                isPlaying = false;
                playPauseBtn.textContent = 'â–¶';
                if (speechSynth) speechSynth.pause();
            } else {
                isPlaying = true;
                playPauseBtn.textContent = 'â¸';
                if (speechSynth) speechSynth.resume();
                // Continue from current scene
                playScene(currentScene);
            }
        }

        function restartAnimation() {
            isPlaying = false;
            if (speechSynth) speechSynth.cancel();
            clearCanvas();
            hideHand();
            currentScene = 0;
            progressBar.style.width = '0%';
            subtitles.classList.remove('visible');

            setTimeout(() => {
                isPlaying = true;
                playPauseBtn.textContent = 'â¸';
                playScene(0);
            }, 300);
        }

        function toggleMute() {
            isMuted = !isMuted;
            muteBtn.textContent = isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
            muteBtn.classList.toggle('muted', isMuted);

            if (isMuted && speechSynth) {
                speechSynth.cancel();
            }
        }

        // Load voices when available
        if (speechSynth) {
            speechSynth.onvoiceschanged = () => {
                speechSynth.getVoices();
            };
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (document.getElementById('introOverlay').classList.contains('hidden')) {
                    togglePlayPause();
                } else {
                    startAnimation();
                }
            } else if (e.code === 'KeyM') {
                toggleMute();
            } else if (e.code === 'KeyR') {
                restartAnimation();
            }
        });
    </script>
</body>
</html>
