# QBITEL Security and Compliance Validation Configuration

endpoints:
  dataplane: "http://localhost:9090"
  controlplane: "http://localhost:8080"  
  aiengine: "http://localhost:8000"
  policy_engine: "http://localhost:8001"
  mgmtapi: "http://localhost:8002"

kubernetes:
  namespace: "qbitel-prod"
  context: "default"
  config_path: "~/.kube/config"

security:
  tls_min_version: "1.3"
  cipher_suites:
    - "TLS_AES_256_GCM_SHA384"
    - "TLS_CHACHA20_POLY1305_SHA256"
    - "TLS_AES_128_GCM_SHA256"
  quantum_safe_required: true
  certificate_validity_days: 90
  max_certificate_chain_length: 3
  require_client_certificates: true
  
  # Certificate paths for validation
  certificate_paths:
    ca_cert: "/etc/ssl/certs/qbitel-ca.crt"
    server_cert: "/etc/ssl/certs/qbitel-server.crt"
    client_cert: "/etc/ssl/certs/qbitel-client.crt"
    
  # Key management configuration
  key_management:
    hsm_required: false
    key_rotation_days: 30
    key_escrow_required: true
    
  # Encryption requirements
  encryption:
    min_key_size: 256
    approved_algorithms:
      - "AES-256-GCM"
      - "ChaCha20-Poly1305"
      - "AES-256-CBC"
    database_encryption_required: true
    filesystem_encryption_required: true
    backup_encryption_required: true

network:
  # Network security requirements
  segmentation_required: true
  micro_segmentation_enabled: true
  network_policies_required: true
  
  # Firewall configuration
  firewall:
    default_deny: true
    ingress_rules_required: true
    egress_rules_required: true
    
  # Monitoring and detection
  intrusion_detection_required: true
  network_monitoring_required: true
  ddos_protection_enabled: true

authentication:
  # Multi-factor authentication
  mfa_required: true
  mfa_methods:
    - "TOTP"
    - "WebAuthn"
    - "SMS"
    
  # Session management
  session_timeout_minutes: 30
  concurrent_sessions_limit: 3
  secure_session_cookies: true
  
  # Access controls
  rbac_enabled: true
  principle_of_least_privilege: true
  privileged_access_monitoring: true

compliance:
  # Compliance frameworks to validate
  frameworks: 
    - "SOC2"
    - "GDPR"
    - "HIPAA"
    - "ISO27001"
    - "NIST"
    
  # Audit and logging requirements
  audit_retention_days: 2555  # 7 years
  audit_log_immutability: true
  real_time_monitoring: true
  
  # Data protection requirements
  data_encryption_required: true
  data_classification_required: true
  data_loss_prevention: true
  access_logging_required: true
  
  # Privacy requirements
  privacy_by_design: true
  data_minimization: true
  consent_management: true
  right_to_deletion: true
  data_portability: true
  
  # SOC 2 specific requirements
  soc2:
    security_controls_required: true
    availability_sla: 99.9
    processing_integrity_controls: true
    confidentiality_controls: true
    privacy_controls: true
    
  # GDPR specific requirements  
  gdpr:
    dpia_required: true
    privacy_officer_assigned: true
    breach_notification_enabled: true
    cross_border_transfer_controls: true
    
  # HIPAA specific requirements
  hipaa:
    administrative_safeguards: true
    physical_safeguards: true
    technical_safeguards: true
    minimum_necessary_standard: true

infrastructure:
  # Container and Kubernetes security
  container_security:
    image_scanning_required: true
    runtime_security_enabled: true
    pod_security_policies: true
    security_contexts_required: true
    non_root_containers: true
    read_only_root_filesystem: true
    
  # System hardening
  system_hardening:
    cis_benchmark_compliance: true
    kernel_hardening: true
    service_minimization: true
    patch_management: true
    
  # High availability and disaster recovery
  availability:
    multi_zone_deployment: true
    backup_frequency_hours: 6
    rpo_minutes: 15  # Recovery Point Objective
    rto_minutes: 60  # Recovery Time Objective

operational:
  # Incident response
  incident_response:
    playbooks_defined: true
    escalation_procedures: true
    communication_plan: true
    forensic_capabilities: true
    
  # Vulnerability management
  vulnerability_management:
    regular_scanning: true
    penetration_testing_frequency_months: 6
    vulnerability_remediation_sla_days: 30
    
  # Security monitoring
  monitoring:
    siem_deployed: true
    threat_intelligence_feeds: true
    security_orchestration: true
    automated_response: true
    
  # Business continuity
  business_continuity:
    disaster_recovery_plan: true
    business_impact_analysis: true
    continuity_testing_frequency_months: 6

# Test execution configuration
testing:
  parallel_execution: true
  timeout_seconds: 300
  retry_attempts: 3
  
  # Test categories to run
  categories:
    - "cryptography"
    - "network_security"
    - "authentication"
    - "infrastructure"
    - "operational"
    - "compliance"
    
  # Severity levels to report
  report_severity_levels:
    - "CRITICAL"
    - "HIGH" 
    - "MEDIUM"
    - "LOW"
    - "INFO"
    
  # Output configuration
  output:
    format: "json"
    detailed_report: true
    summary_report: true
    export_metrics: true

# Environment-specific overrides
environments:
  development:
    security:
      quantum_safe_required: false
      certificate_validity_days: 365
    compliance:
      audit_retention_days: 90
      
  staging:
    security:
      quantum_safe_required: true
      certificate_validity_days: 180
    compliance:
      audit_retention_days: 365
      
  production:
    security:
      quantum_safe_required: true
      certificate_validity_days: 90
    compliance:
      audit_retention_days: 2555
      frameworks:
        - "SOC2"
        - "GDPR" 
        - "HIPAA"
        - "ISO27001"
        - "NIST"
        - "PCI_DSS"